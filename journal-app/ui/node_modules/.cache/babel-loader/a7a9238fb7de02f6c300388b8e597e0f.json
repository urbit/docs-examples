{"ast":null,"code":"import _toConsumableArray from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/home/mike/proj/frontend/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{Component}from'react';import Urbit from'@urbit/http-api';import'bootstrap/dist/css/bootstrap.min.css';import'react-day-picker/lib/style.css';import TextareaAutosize from'react-textarea-autosize';import Button from'react-bootstrap/Button';import Card from'react-bootstrap/Card';import Stack from'react-bootstrap/Stack';import Tab from'react-bootstrap/Tab';import Tabs from'react-bootstrap/Tabs';import ToastContainer from'react-bootstrap/ToastContainer';import Toast from'react-bootstrap/Toast';import Spinner from'react-bootstrap/Spinner';import CloseButton from'react-bootstrap/CloseButton';import Modal from'react-bootstrap/Modal';import DayPickerInput from'react-day-picker/DayPickerInput';import endOfDay from'date-fns/endOfDay';import startOfDay from'date-fns/startOfDay';import{BottomScrollListener}from'react-bottom-scroll-listener';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={entries:[],drafts:{},newDraft:{},results:[],searchTime:null,searchStart:null,searchEnd:null,resultStart:null,resultEnd:null,latestUpdate:null,entryToDelete:null,status:null,errorCount:0,errors:new Map()};_this.init=function(){_this.getEntries().then(function(result){_this.handleUpdate(result);_this.setState({latestUpdate:result.time});_this.subscribe();},function(err){_this.setErrorMsg(\"Connection failed\");_this.setState({status:\"err\"});});};_this.reconnect=function(){window.urbit.reset();var latest=_this.state.latestUpdate;if(latest===null){_this.init();}else{_this.getUpdates().then(function(result){result.logs.map(function(e){return _this.handleUpdate(e);});_this.subscribe();},function(err){_this.setErrorMsg(\"Connection failed\");_this.setState({status:\"err\"});});}};_this.getUpdates=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var latest,since,path;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:latest=_this.state.latestUpdate;since=latest===null?Date.now():latest;path=\"/updates/since/\".concat(since);return _context.abrupt(\"return\",window.urbit.scry({app:\"journal\",path:path}));case 4:case\"end\":return _context.stop();}}},_callee);}));_this.getEntries=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var e,before,max,path;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e=_this.state.entries;before=e.length===0?Date.now():e[e.length-1].id;max=10;path=\"/entries/before/\".concat(before,\"/\").concat(max);return _context2.abrupt(\"return\",window.urbit.scry({app:\"journal\",path:path}));case 5:case\"end\":return _context2.stop();}}},_callee2);}));_this.moreEntries=function(){_this.getEntries().then(function(result){_this.handleUpdate(result);},function(err){_this.setErrorMsg(\"Fetching more entries failed\");});};_this.subscribe=function(){try{window.urbit.subscribe({app:\"journal\",path:\"/updates\",event:_this.handleUpdate,err:function err(){return _this.setErrorMsg(\"Subscription rejected\");},quit:function quit(){return _this.setErrorMsg(\"Kicked from subscription\");}});}catch(_unused){_this.setErrorMsg(\"Subscription failed\");}};_this.delete=function(id){window.urbit.poke({app:\"journal\",mark:\"journal-action\",json:{\"del\":{\"id\":id}},onError:function onError(){return _this.setErrorMsg(\"Deletion rejected\");}});_this.setState({rmModalShow:false,entryToDelete:null});};_this.submitEdit=function(id,txt){if(txt!==null){window.urbit.poke({app:\"journal\",mark:\"journal-action\",json:{\"edit\":{\"id\":id,\"txt\":txt}},onError:function onError(){return _this.setErrorMsg(\"Edit rejected\");}});}else _this.cancelEdit(id);};_this.submitNew=function(id,txt){window.urbit.poke({app:\"journal\",mark:\"journal-action\",json:{\"add\":{\"id\":id,\"txt\":txt}},onSuccess:function onSuccess(){return _this.setState({newDraft:{}});},onError:function onError(){return _this.setErrorMsg(\"New entry rejected\");}});};_this.getSearch=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this$state,ss,se,lu,start,end,path;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$state=_this.state,ss=_this$state.searchStart,se=_this$state.searchEnd,lu=_this$state.latestUpdate;if(lu!==null&&ss!==null&&se!==null){start=ss.getTime();end=se.getTime();if(start<0)start=0;if(end<0)end=0;path=\"/entries/between/\".concat(start,\"/\").concat(end);window.urbit.scry({app:\"journal\",path:path}).then(function(result){_this.setState({searchTime:result.time,searchStart:null,searchEnd:null,resultStart:ss,resultEnd:se,results:result.entries});},function(err){_this.setErrorMsg(\"Search failed\");});}else{lu!==null&&_this.setErrorMsg(\"Searh failed\");}case 2:case\"end\":return _context3.stop();}}},_callee3);}));_this.spot=function(id,data){var low=0;var high=data.length;while(low<high){var mid=low+high>>>1;if(data[mid].id>id)low=mid+1;else high=mid;}return low;};_this.inSearch=function(id,time){var _this$state2=_this.state,searchTime=_this$state2.searchTime,resultStart=_this$state2.resultStart,resultEnd=_this$state2.resultEnd;return searchTime!==null&&time>=searchTime&&resultStart.getTime()<=id&&resultEnd.getTime()>=id;};_this.handleUpdate=function(upd){var _this$state3=_this.state,entries=_this$state3.entries,drafts=_this$state3.drafts,results=_this$state3.results,latestUpdate=_this$state3.latestUpdate;if(upd.time!==latestUpdate){if(\"entries\"in upd){_this.setState({entries:entries.concat(upd.entries)});}else if(\"add\"in upd){var time=upd.time,add=upd.add;var eInd=_this.spot(add.id,entries);var rInd=_this.spot(add.id,results);var toE=add.id>entries[entries.length-1].id;var toR=_this.inSearch(add.id,time);toE&&entries.splice(eInd,0,add);toR&&results.splice(rInd,0,add);_this.setState(_objectSpread(_objectSpread(_objectSpread({},toE&&{entries:entries}),toR&&{results:results}),{},{latestUpdate:time}));}else if(\"edit\"in upd){var _time=upd.time,edit=upd.edit;var _eInd=entries.findIndex(function(e){return e.id===edit.id;});var _rInd=results.findIndex(function(e){return e.id===edit.id;});var _toE=_eInd!==-1;var _toR=_rInd!==-1&&_this.inSearch(edit.id,_time);if(_toE)entries[_eInd]=edit;if(_toR)results[_rInd]=edit;(_toE||_toR)&&delete drafts[edit.id];_this.setState(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},_toE&&{entries:entries}),_toR&&{results:results}),(_toE||_toR)&&{drafts:drafts}),{},{latestUpdate:_time}));}else if(\"del\"in upd){var _time2=upd.time,del=upd.del;var _eInd2=entries.findIndex(function(e){return e.id===del.id;});var _rInd2=results.findIndex(function(e){return e.id===del.id;});var _toE2=_eInd2!==-1;var _toR2=_this.inSearch(del.id,_time2)&&_rInd2!==-1;_toE2&&entries.splice(_eInd2,1);_toR2&&results.splice(_rInd2,1);(_toE2||_toR2)&&delete drafts[del.id];_this.setState(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},_toE2&&{entries:entries}),_toR2&&{results:results}),(_toE2||_toR2)&&{drafts:drafts}),{},{latestUpdate:_time2}));}}};_this.cancelEdit=function(id){var drafts=_this.state.drafts;delete drafts[id];_this.setState({drafts:drafts});};_this.saveDraft=function(id,text){var drafts=_this.state.drafts;drafts[id]=text;_this.setState({drafts:drafts});};_this.setEdit=function(id){var drafts=_this.state.drafts;if(!(id in drafts)){drafts[id]=null;_this.setState({drafts:drafts});}};_this.saveNew=function(id,txt){txt!==\"\"?_this.setState({newDraft:{id:id,txt:txt}}):_this.setState({newDraft:{}});};_this.newEntry=function(){var n=_this.state.newDraft;var isNew=Object.keys(n).length===0;var now=Date.now();return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(TextareaAutosize,{className:\"w-100 form-control\",placeholder:\"New journal entry\",value:isNew?\"\":n.txt,onChange:function onChange(e){return _this.saveNew(isNew?now:n.id,e.target.value);}}),!isNew&&/*#__PURE__*/_jsx(Button,{className:\"w-100 mt-3\",variant:\"outline-primary\",onClick:function onClick(){return _this.submitNew(n.id,n.txt);},children:\"Submit\"})]});};_this.closeRmModal=function(){_this.setState({entryToDelete:null});};_this.openRmModal=function(id){_this.setState({entryToDelete:id});};_this.rmModal=function(){var id=_this.state.entryToDelete;if(id!==null){return/*#__PURE__*/_jsxs(Modal,{size:\"lg\",centered:true,show:id!==null,onHide:function onHide(){return _this.closeRmModal();},children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Confirm Delete\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:\"Are you sure you want to delete this journal entry?\"}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:function onClick(){return _this.delete(id);},children:\"Delete\"})})]});}};_this.editBox=function(id,txt,draft){return/*#__PURE__*/_jsx(TextareaAutosize,{className:\"w-100 form-control\",value:draft===null?txt:draft,onChange:function onChange(e){return _this.saveDraft(id,e.target.value);}});};_this.printEntry=function(_ref4){var id=_ref4.id,txt=_ref4.txt;var drafts=_this.state.drafts;var edit=(id in drafts);var draft=id in drafts?drafts[id]:null;var reg=/(?:\\r?\\n[ \\t]*){2,}(?!\\s*$)/;var d=new Date(id);return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"fs-4 d-flex align-items-center justify-content-between\",children:[d.toLocaleString(),/*#__PURE__*/_jsx(CloseButton,{className:\"fs-6\",onClick:function onClick(){return edit?_this.cancelEdit(id):_this.openRmModal(id);}})]}),/*#__PURE__*/_jsx(Card.Body,{onClick:function onClick(){return _this.setEdit(id);},children:edit?_this.editBox(id,txt,draft):txt.split(reg).map(function(e,ind){return/*#__PURE__*/_jsx(\"p\",{children:e},ind);})}),edit&&/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",className:\"mx-3 mb-3\",onClick:function onClick(){return _this.submitEdit(id,draft);},children:\"Submit\"})]},id);};_this.setSearchStart=function(when){if(when instanceof Date&&!isNaN(when)){var date=startOfDay(when);_this.setState({searchStart:date});}else _this.setState({searchStart:null});};_this.setSearchEnd=function(when){if(when instanceof Date&&!isNaN(when)){var date=endOfDay(when);_this.setState({searchEnd:date});}else _this.setState({searchEnd:null});};_this.searcher=function(){var _this$state4=_this.state,ss=_this$state4.searchStart,se=_this$state4.searchEnd,rs=_this$state4.resultStart,re=_this$state4.resultEnd;return/*#__PURE__*/_jsxs(Stack,{gap:5,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"me-2 d-flex justify-content-start align-items-center flex-wrap\",children:[/*#__PURE__*/_jsx(DayPickerInput,{value:ss,placeholder:\"FROM  YYYY-M-D\",onDayChange:function onDayChange(day){return _this.setSearchStart(day);},style:{margin:\"5px 5px 5px 0\"}}),/*#__PURE__*/_jsx(DayPickerInput,{value:se,placeholder:\"TO  YYYY-M-D\",onDayChange:function onDayChange(day){return _this.setSearchEnd(day);},style:{margin:\"5px 5px 5px 0\"}})]}),/*#__PURE__*/_jsx(Button,{className:\"w-20\",variant:ss===null||se===null?\"outline-secondary\":\"outline-primary\",disabled:ss===null||se===null,onClick:function onClick(){return _this.getSearch();},children:\"Search\"})]}),rs!==null&&re!==null&&/*#__PURE__*/_jsxs(\"div\",{className:\"fs-4\",children:[\"Results for \",rs.toLocaleDateString(),\" to \",re.toLocaleDateString()]})]});};_this.setErrorMsg=function(msg){var _this$state5=_this.state,errors=_this$state5.errors,errorCount=_this$state5.errorCount;var id=errorCount+1;_this.setState({errors:errors.set(id,msg),errorCount:id});};_this.rmErrorMsg=function(id){var errors=_this.state.errors;errors.delete(id);_this.setState({errors:errors});};_this.errorMsg=function(id,msg){return/*#__PURE__*/_jsx(Toast,{className:\"ms-auto\",onClose:function onClose(){return _this.rmErrorMsg(id);},show:true,delay:3000,autohide:true,style:{width:\"fit-content\"},children:/*#__PURE__*/_jsx(Toast.Header,{className:\"d-flex justify-content-between\",children:msg})},id);};_this.status=function(){var _this$state6=_this.state,status=_this$state6.status,errors=_this$state6.errors;return/*#__PURE__*/_jsxs(ToastContainer,{style:{position:\"sticky\",bottom:0,width:\"100%\",zIndex:50},children:[_toConsumableArray(errors).map(function(e){return _this.errorMsg(e[0],e[1]);}),/*#__PURE__*/_jsx(Toast,{bg:status===\"try\"?\"warning\":\"danger\",className:\"w-100\",show:status===\"try\"||status===\"err\",children:/*#__PURE__*/_jsx(Toast.Body,{className:\"d-flex justify-content-center align-items-center\",onClick:status===\"err\"?function(){return _this.reconnect();}:null,role:status===\"err\"?\"button\":undefined,children:/*#__PURE__*/_jsxs(\"strong\",{style:{color:\"white\"},children:[status===\"try\"&&/*#__PURE__*/_jsx(Spinner,{animation:\"border\",size:\"sm\",className:\"me-1\"}),status===\"try\"&&\"Reconnecting\",status===\"err\"&&\"Reconnect\"]})})})]});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;window.urbit=new Urbit(\"\");window.urbit.ship=window.ship;window.urbit.onOpen=function(){return _this2.setState({status:\"con\"});};window.urbit.onRetry=function(){return _this2.setState({status:\"try\"});};window.urbit.onError=function(err){return _this2.setState({status:\"err\"});};this.init();}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(React.Fragment,{children:[this.rmModal(),/*#__PURE__*/_jsx(\"div\",{className:\"m-3 d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(Card,{style:{maxWidth:\"50rem\",width:\"100%\"},children:[/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"journal\",className:\"fs-2\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"journal\",title:\"Journal\",children:/*#__PURE__*/_jsx(BottomScrollListener,{onBottom:function onBottom(){return _this3.moreEntries();},children:function children(scrollRef){return/*#__PURE__*/_jsxs(Stack,{gap:5,className:\"m-3 d-flex\",children:[_this3.newEntry(),_this3.state.entries.map(function(e){return _this3.printEntry(e);})]});}})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"search\",title:\"Search\",children:/*#__PURE__*/_jsxs(Stack,{gap:5,className:\"m-3 d-flex\",children:[this.searcher(),this.state.results.map(function(e){return _this3.printEntry(e);})]})})]}),this.status()]})})]});}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/home/mike/proj/frontend/ui/src/App.js"],"names":["React","Component","Urbit","TextareaAutosize","Button","Card","Stack","Tab","Tabs","ToastContainer","Toast","Spinner","CloseButton","Modal","DayPickerInput","endOfDay","startOfDay","BottomScrollListener","App","state","entries","drafts","newDraft","results","searchTime","searchStart","searchEnd","resultStart","resultEnd","latestUpdate","entryToDelete","status","errorCount","errors","Map","init","getEntries","then","result","handleUpdate","setState","time","subscribe","err","setErrorMsg","reconnect","window","urbit","reset","latest","getUpdates","logs","map","e","since","Date","now","path","scry","app","before","length","id","max","moreEntries","event","quit","delete","poke","mark","json","onError","rmModalShow","submitEdit","txt","cancelEdit","submitNew","onSuccess","getSearch","ss","se","lu","start","getTime","end","spot","data","low","high","mid","inSearch","upd","concat","add","eInd","rInd","toE","toR","splice","edit","findIndex","del","saveDraft","text","setEdit","saveNew","newEntry","n","isNew","Object","keys","target","value","closeRmModal","openRmModal","rmModal","editBox","draft","printEntry","reg","d","toLocaleString","split","ind","setSearchStart","when","isNaN","date","setSearchEnd","searcher","rs","re","day","margin","toLocaleDateString","msg","set","rmErrorMsg","errorMsg","width","position","bottom","zIndex","undefined","color","ship","onOpen","onRetry","maxWidth","scrollRef"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Urbit from '@urbit/http-api';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'react-day-picker/lib/style.css';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport Button from 'react-bootstrap/Button';\nimport Card from 'react-bootstrap/Card';\nimport Stack from 'react-bootstrap/Stack';\nimport Tab from 'react-bootstrap/Tab';\nimport Tabs from 'react-bootstrap/Tabs';\nimport ToastContainer from 'react-bootstrap/ToastContainer';\nimport Toast from 'react-bootstrap/Toast';\nimport Spinner from 'react-bootstrap/Spinner';\nimport CloseButton from 'react-bootstrap/CloseButton';\nimport Modal from 'react-bootstrap/Modal';\nimport DayPickerInput from 'react-day-picker/DayPickerInput';\nimport endOfDay from 'date-fns/endOfDay';\nimport startOfDay from 'date-fns/startOfDay';\nimport {BottomScrollListener} from 'react-bottom-scroll-listener';\n\n\nclass App extends Component {\n  state = {\n    entries: [],\n    drafts: {},\n    newDraft: {},\n    results: [],\n    searchTime: null,\n    searchStart: null,\n    searchEnd: null,\n    resultStart: null,\n    resultEnd: null,\n    latestUpdate: null,\n    entryToDelete: null,\n    status: null,\n    errorCount: 0,\n    errors: new Map(),\n  };\n\n  componentDidMount() {\n    window.urbit = new Urbit(\"\");\n    window.urbit.ship = window.ship;\n    window.urbit.onOpen = () => this.setState({status: \"con\"});\n    window.urbit.onRetry = () => this.setState({status: \"try\"});\n    window.urbit.onError = (err) => this.setState({status: \"err\"});\n    this.init();\n  };\n\n  init = () => {\n    this.getEntries()\n    .then(\n      (result) => {\n        this.handleUpdate(result);\n        this.setState({latestUpdate: result.time});\n        this.subscribe()\n      },\n      (err) => {\n        this.setErrorMsg(\"Connection failed\");\n        this.setState({status: \"err\"})\n      }\n    )\n  };\n\n  reconnect = () => {\n    window.urbit.reset();\n    const latest = this.state.latestUpdate;\n    if (latest === null) {\n      this.init();\n    } else {\n      this.getUpdates()\n      .then(\n        (result) => {\n          result.logs.map(e => this.handleUpdate(e));\n          this.subscribe()\n        },\n        (err) => {\n          this.setErrorMsg(\"Connection failed\");\n          this.setState({status: \"err\"})\n        }\n      )\n    }\n  };\n\n  getUpdates = async () => {\n    const {latestUpdate: latest} = this.state;\n    const since = (latest === null) ? Date.now() : latest;\n    const path = `/updates/since/${since}`;\n    return window.urbit.scry({\n      app: \"journal\",\n      path: path\n    })\n  };\n\n  getEntries = async () => {\n    const {entries: e} = this.state;\n    const before = (e.length === 0) ? Date.now() : e[e.length - 1].id;\n    const max = 10;\n    const path = `/entries/before/${before}/${max}`;\n    return window.urbit.scry({\n      app: \"journal\",\n      path: path\n    })\n  };\n\n  moreEntries = () => {\n    this.getEntries()\n    .then(\n      (result) => {this.handleUpdate(result)},\n      (err) => {this.setErrorMsg(\"Fetching more entries failed\")}\n    )\n  };\n\n  subscribe = () => {\n    try {\n      window.urbit.subscribe({\n        app: \"journal\",\n        path: \"/updates\",\n        event: this.handleUpdate,\n        err: ()=>this.setErrorMsg(\"Subscription rejected\"),\n        quit: ()=>this.setErrorMsg(\"Kicked from subscription\")\n      })\n    } catch {\n      this.setErrorMsg(\"Subscription failed\")\n    }\n  };\n\n  delete = (id) => {\n    window.urbit.poke({\n      app: \"journal\",\n      mark: \"journal-action\",\n      json: {\"del\": {\"id\": id}},\n      onError: ()=>this.setErrorMsg(\"Deletion rejected\")\n    })\n    this.setState({rmModalShow: false, entryToDelete: null})\n  };\n\n  submitEdit = (id, txt) => {\n    if (txt !== null) {\n      window.urbit.poke({\n        app: \"journal\",\n        mark: \"journal-action\",\n        json: {\"edit\": {\"id\": id, \"txt\": txt}},\n        onError: ()=>this.setErrorMsg(\"Edit rejected\")\n      })\n    } else this.cancelEdit(id)\n  };\n\n  submitNew = (id, txt) => {\n    window.urbit.poke({\n      app: \"journal\",\n      mark: \"journal-action\",\n      json: {\"add\": {\"id\": id, \"txt\": txt}},\n      onSuccess: ()=>this.setState({newDraft: {}}),\n      onError: ()=>this.setErrorMsg(\"New entry rejected\")\n    })\n  };\n\n  getSearch = async () => {\n    const {\n      searchStart: ss,\n      searchEnd: se,\n      latestUpdate: lu\n    } = this.state;\n    if (lu !== null && ss !== null && se !== null) {\n      let start = ss.getTime();\n      let end = se.getTime();\n      if (start < 0) start = 0;\n      if (end < 0) end = 0;\n      const path = `/entries/between/${start}/${end}`;\n      window.urbit.scry({\n        app: \"journal\",\n        path: path\n      })\n      .then(\n        (result) => {\n          this.setState({\n            searchTime: result.time,\n            searchStart: null,\n            searchEnd: null,\n            resultStart: ss,\n            resultEnd: se,\n            results: result.entries\n          })\n        },\n        (err) => {\n          this.setErrorMsg(\"Search failed\")\n        }\n      )\n    } else {\n      (lu !== null) && this.setErrorMsg(\"Searh failed\")\n    }\n  };\n\n  spot = (id, data) => {\n    let low = 0\n    let high = data.length;\n    while (low < high) {\n      let mid = (low + high) >>> 1;\n      if (data[mid].id > id) low = mid + 1;\n      else high = mid;\n    }\n    return low;\n  };\n\n  inSearch = (id, time) => {\n    const {\n      searchTime,\n      resultStart,\n      resultEnd\n    } = this.state;\n    return (\n      searchTime !== null &&\n        time >= searchTime &&\n        resultStart.getTime() <= id &&\n        resultEnd.getTime() >= id\n    )\n  };\n\n  handleUpdate = (upd) => {\n    const {entries, drafts, results, latestUpdate} = this.state;\n    if (upd.time !== latestUpdate) {\n      if (\"entries\" in upd) {\n        this.setState({entries: entries.concat(upd.entries)})\n      } else if (\"add\" in upd) {\n        const {time, add} = upd;\n        const eInd = this.spot(add.id, entries);\n        const rInd = this.spot(add.id, results);\n        const toE = (add.id > entries[entries.length - 1].id);\n        const toR = (this.inSearch(add.id, time));\n        toE && entries.splice(eInd, 0, add);\n        toR && results.splice(rInd, 0, add);\n        this.setState({\n          ...(toE && {entries: entries}),\n          ...(toR && {results: results}),\n          latestUpdate: time\n        })\n      } else if (\"edit\" in upd) {\n        const {time, edit} = upd;\n        const eInd = entries.findIndex(e => e.id === edit.id);\n        const rInd = results.findIndex(e => e.id === edit.id);\n        const toE = eInd !== -1;\n        const toR = rInd !== -1 && this.inSearch(edit.id, time);\n        if (toE) entries[eInd] = edit;\n        if (toR) results[rInd] = edit;\n        (toE || toR) && delete drafts[edit.id];\n        this.setState({\n          ...(toE && {entries: entries}),\n          ...(toR && {results: results}),\n          ...((toE || toR) && {drafts: drafts}),\n          latestUpdate: time\n        })\n      } else if (\"del\" in upd) {\n        const {time, del} = upd;\n        const eInd = entries.findIndex(e => e.id === del.id);\n        const rInd = results.findIndex(e => e.id === del.id);\n        const toE = eInd !== -1;\n        const toR = (this.inSearch(del.id, time)) && rInd !== -1;\n        (toE) && entries.splice(eInd, 1);\n        (toR) && results.splice(rInd, 1);\n        (toE || toR) && delete drafts[del.id];\n        this.setState({\n          ...(toE && {entries: entries}),\n          ...(toR && {results: results}),\n          ...((toE || toR) && {drafts: drafts}),\n          latestUpdate: time\n        })\n      }\n    }\n  };\n\n  cancelEdit = (id) => {\n    const {drafts} = this.state;\n    delete drafts[id];\n    this.setState({drafts: drafts})\n  };\n\n  saveDraft = (id, text) => {\n    const {drafts} = this.state;\n    drafts[id] = text;\n    this.setState({drafts: drafts})\n  };\n\n  setEdit = (id) => {\n    const {drafts} = this.state;\n    if (!(id in drafts)) {\n      drafts[id] = null;\n      this.setState({drafts: drafts})\n    }\n  };\n\n  saveNew = (id, txt) => {\n    (txt !== \"\")\n      ? this.setState({newDraft: {id: id, txt: txt}})\n      : this.setState({newDraft: {}})\n  };\n\n  newEntry = () => {\n    const {newDraft: n} = this.state;\n    const isNew = (Object.keys(n).length === 0);\n    const now = Date.now();\n    return (\n      <div className=\"d-flex flex-column\">\n        <TextareaAutosize\n          className=\"w-100 form-control\"\n          placeholder=\"New journal entry\"\n          value={(isNew) ? \"\" : n.txt}\n          onChange={e => this.saveNew((isNew) ? now : n.id, e.target.value)}\n        />\n        {(!isNew) &&\n          <Button\n            className=\"w-100 mt-3\"\n            variant=\"outline-primary\"\n            onClick={()=>this.submitNew(n.id, n.txt)}\n          >\n            Submit\n          </Button>\n        }\n      </div>\n    )\n  };\n\n  closeRmModal = () => {\n    this.setState({entryToDelete: null})\n  };\n\n  openRmModal = (id) => {\n    this.setState({entryToDelete: id})\n  };\n\n  rmModal = () => {\n    const id = this.state.entryToDelete;\n    if (id !== null) {\n      return (\n        <Modal\n          size=\"lg\"\n          centered\n          show={(id !== null)}\n          onHide={()=>this.closeRmModal()}\n        >\n          <Modal.Header closeButton>\n            <Modal.Title>Confirm Delete</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            Are you sure you want to delete this journal entry?\n          </Modal.Body>\n          <Modal.Footer>\n            <Button\n              variant=\"outline-danger\"\n              onClick={()=>this.delete(id)}\n            >\n              Delete\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      )\n    }\n  };\n\n  editBox = (id, txt, draft) => {\n    return (\n      <TextareaAutosize\n        className=\"w-100 form-control\"\n        value={(draft === null) ? txt : draft}\n        onChange={(e) => this.saveDraft(id, e.target.value)}\n      />\n    );\n  };\n\n  printEntry = ({id, txt}) => {\n    const {drafts} = this.state;\n    const edit = (id in drafts);\n    const draft = (id in drafts) ? drafts[id] : null;\n    const reg = /(?:\\r?\\n[ \\t]*){2,}(?!\\s*$)/;\n    let d = new Date(id);\n    return (\n      <Card key={id}>\n        <Card.Header\n          className=\"fs-4 d-flex align-items-center justify-content-between\"\n        >\n          {d.toLocaleString()}\n          <CloseButton\n            className=\"fs-6\"\n            onClick={() => (edit) ? this.cancelEdit(id) : this.openRmModal(id)}\n          />\n        </Card.Header>\n        <Card.Body onClick={()=>this.setEdit(id)}>\n          {(edit)\n           ? this.editBox(id, txt, draft)\n           : txt.split(reg).map((e, ind) => <p key={ind}>{e}</p>)\n          }\n        </Card.Body>\n        {(edit) &&\n          <Button\n            variant=\"outline-primary\"\n            className=\"mx-3 mb-3\"\n            onClick={()=>this.submitEdit(id, draft)}\n          >\n            Submit\n          </Button>\n        }\n      </Card>\n    )\n  };\n\n  setSearchStart = (when) => {\n    if (when instanceof Date && !isNaN(when)) {\n      const date = startOfDay(when);\n      this.setState({searchStart: date})\n    } else this.setState({searchStart: null})\n  };\n\n  setSearchEnd = (when) => {\n    if (when instanceof Date && !isNaN(when)) {\n      const date = endOfDay(when);\n      this.setState({searchEnd: date})\n    } else this.setState({searchEnd: null})\n  };\n\n  searcher = () => {\n    const {\n      searchStart: ss,\n      searchEnd: se,\n      resultStart: rs,\n      resultEnd: re\n    } = this.state;\n    return (\n      <Stack gap={5}>\n        <div className=\"d-flex justify-content-between\">\n          <div\n            className=\"me-2 d-flex justify-content-start align-items-center flex-wrap\"\n          >\n            <DayPickerInput\n              value={ss}\n              placeholder=\"FROM  YYYY-M-D\"\n              onDayChange={day => this.setSearchStart(day)}\n              style={{margin: \"5px 5px 5px 0\"}}\n            />\n            <DayPickerInput\n              value={se}\n              placeholder=\"TO  YYYY-M-D\"\n              onDayChange={day => this.setSearchEnd(day)}\n              style={{margin: \"5px 5px 5px 0\"}}\n            />\n          </div>\n          <Button\n            className=\"w-20\"\n            variant={\n              (ss === null || se === null)\n                ? \"outline-secondary\" : \"outline-primary\"\n            }\n            disabled={ss === null || se === null}\n            onClick={()=>this.getSearch()}\n          >\n            Search\n          </Button>\n        </div>\n        { (rs !== null && re !== null) &&\n            <div className=\"fs-4\">\n              Results for {rs.toLocaleDateString()} to {re.toLocaleDateString()}\n            </div>\n        }\n      </Stack>\n    )\n  };\n\n  setErrorMsg = (msg) => {\n    const {errors, errorCount} = this.state;\n    const id = errorCount + 1;\n    this.setState({\n      errors: errors.set(id, msg),\n      errorCount: id\n    })\n  };\n\n  rmErrorMsg = (id) => {\n    const {errors} = this.state;\n    errors.delete(id);\n    this.setState({\n      errors: errors,\n    })\n  };\n\n  errorMsg = (id, msg) => {\n    return (\n      <Toast\n        key={id}\n        className=\"ms-auto\"\n        onClose={() => this.rmErrorMsg(id)}\n        show={true}\n        delay={3000}\n        autohide\n        style={{width: \"fit-content\"}}\n      >\n        <Toast.Header className=\"d-flex justify-content-between\">\n          {msg}\n        </Toast.Header>\n      </Toast>\n    )\n  };\n\n  status = () => {\n    const {status, errors} = this.state;\n    return (\n      <ToastContainer\n        style={{\n          position: \"sticky\",\n          bottom: 0,\n          width: \"100%\",\n          zIndex: 50\n        }}\n      >\n        {[...errors].map((e) => this.errorMsg(e[0],e[1]))}\n        <Toast\n          bg={(status === \"try\") ? \"warning\" : \"danger\"}\n          className=\"w-100\"\n          show={(status === \"try\" || status === \"err\")}\n        >\n          <Toast.Body\n            className=\"d-flex justify-content-center align-items-center\"\n            onClick={(status === \"err\") ? () => this.reconnect() : null}\n            role={(status === \"err\") ? \"button\" : undefined}\n\n          >\n            <strong style={{color: \"white\"}}>\n              {\n                (status === \"try\")\n                  && <Spinner animation=\"border\" size=\"sm\" className=\"me-1\"/>\n              }\n              {(status === \"try\") && \"Reconnecting\"}\n              {(status === \"err\") && \"Reconnect\"}\n            </strong>\n          </Toast.Body>\n        </Toast>\n      </ToastContainer>\n    )\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.rmModal()}\n        <div className=\"m-3 d-flex justify-content-center\">\n          <Card style={{maxWidth: \"50rem\", width: \"100%\"}}>\n            <Tabs defaultActiveKey=\"journal\" className=\"fs-2\">\n              <Tab eventKey=\"journal\" title=\"Journal\">\n                <BottomScrollListener onBottom={()=>this.moreEntries()}>\n                  {(scrollRef) =>\n                    <Stack gap={5} className=\"m-3 d-flex\">\n                      {this.newEntry()}\n                      {this.state.entries.map(e => this.printEntry(e))}\n                    </Stack>\n                  }\n                </BottomScrollListener>\n              </Tab>\n              <Tab eventKey=\"search\" title=\"Search\">\n                <Stack gap={5} className=\"m-3 d-flex\">\n                  {this.searcher()}\n                  {this.state.results.map(e => this.printEntry(e))}\n                </Stack>\n              </Tab>\n            </Tabs>\n            {this.status()}\n          </Card>\n        </div>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}